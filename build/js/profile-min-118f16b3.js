!function(){"use strict";function e(e,t,i){var n;return function(){var o=this,l=arguments,s=function(){n=null,i||e.apply(o,l)},a=i&&!n;clearTimeout(n),n=setTimeout(s,t),a&&e.apply(o,l)}}var t=e(function(){var e=$("#tags-expertise"),t=$("#id_profile-interests"),o=t.val().split(",");e.empty(),$.each(o,function(t,i){i=$.trim(i),-1!==window.INTEREST_SUGGESTIONS.indexOf(i)&&e.append('<li class="tag-expert"><label for="expert-'+t+'"><input type="checkbox" name="expert-'+t+'" id="expert-'+t+'" value="'+i+'"> '+i+"</label></li>")}),i(),n()}),i=e(function(){var e=($("#tags-expertise"),$("#id_profile-expertise")),t=e.val().split(",");$("#tags-expertise .tag-expert input[type=checkbox]").removeAttr("checked"),$.each(t,function(e,t){t=$.trim(t),$("#tags-expertise .tag-expert input[value="+t+"]").attr("checked","checked")})}),n=e(function(){var e=$("#tags-expertise .tag-expert input[type=checkbox]:checked").map(function(){return $(this).val()}).get().join(",");$("#id_profile-expertise").val(e)});$(document).ready(function(){$("#id_profile-interests").hide().after('<ul id="tagit-interests"></ul>').change(t),$("#tagit-interests").tagit({availableTags:window.INTEREST_SUGGESTIONS,singleField:!0,singleFieldNode:$("#id_profile-interests"),onTagAdded:t,onTagRemoved:t,onTagClicked:t}),$("#tagit-interests .tagit-new input").attr("placeholder",gettext("New interest...")),$("#id_profile-expertise").hide().after("<ul id='tags-expertise' class='tags'></ul>"),$("#tags-expertise").click(n),t(),$(".wordcount").each(function(e,t){function i(){var e,t=$.trim(a.val()).split(" "),i=o.parent().css("color"),n="#900";""===t[0]&&(t.length=0),s=l-t.length,o.text(s),e=t.length,e>=l&&i!==n?o.parent().css("color",n):t.length<l&&i===n&&o.parent().css("color","")}var n=$(t),o=n.find(".counter"),l=parseInt(o.text(),10),s=0,a=n.children("textarea");i(),a.keypress(i)}),$("#profiles input").mozPlaceholder()})}(),function(e){"use strict";function t(t){return function(){var i=this;e(window)[t]("scroll",function(){e(i).mozillaAutocomplete("reposition")})}}e.widget("ui.mozillaAutocomplete",e.ui.autocomplete,{options:{requireValidOption:!1,onSelect:function(){},onDeselect:function(){},autocompleteURL:"",styleElement:null,minLength:3,buildRequestData:function(e){return e},labelField:"title",_renderItem:null,_renderItemAsLink:!1,open:t("bind"),close:t("unbind")},cache:null,selection:null,lastXHR:null,updateStyles:function(e){var t="ui-autocomplete-input-valid",i="ui-autocomplete-input-invalid",n=this.styleElement;"all"===e?n.removeClass(t).removeClass(i):e?n.addClass(t).removeClass(i):n.removeClass(t).addClass(i)},_suggest:function(t){this.isFocused&&e.ui.autocomplete.prototype._suggest.call(this,t)},deselect:function(){var e=this.selection;this.clear(),this.element.val()&&this.options.requireValidOption&&this.updateStyles(!1),this.options.onDeselect(e)},clear:function(){this.selection=null,this.element.attr("title",gettext("No selection")),this.updateStyles("all")},_create:function(){function t(t){return e.each(t,function(){this.label=this[i.options.labelField]}),t}var i=this;if(e.ui.autocomplete.prototype._create.call(this),!this.cache)var n=this.cache={terms:{},keys:{}};this.isFocused=!1,this.element.focus(function(){i.isFocused=!0}),this.element.blur(function(){i.isFocused=!1;var e=i.element.val();!e||this.selection||n.keys[e.toLowerCase()]||i._search(e)}),this.styleElement=e(this.options.styleElement||this.element);this.source;this.source=e.isArray(this.options.source)?function(n,o){t(i.options.source),o(e.ui.autocomplete.filter(i.options.source,n.term))}:function(o,l){o=this.options.buildRequestData(o);var s=o.term.toLowerCase(),a=l;return l=function(e){a.call(i,e),e.length&&n.keys[s]?i.options.select.call(i,null,{item:n.keys[s]},!0):i.deselect()},n.terms[s]?void l(n.terms[s]):void(i.lastXHR=e.getJSON(i.options.autocompleteUrl,o,function(o,a,r){t(o),e.each(o,function(){n.keys[this.label.toLowerCase()]=this}),n.terms[s]=o,r===i.lastXHR&&l(o)}))};var o=this.options.select;this.options.select=function(e,t,n){var l=i.selection=t.item;void 0!==l.value&&(o&&o.call(i,e,t),l&&i.element.val(l.value),i.updateStyles(!0),i.element.attr("title",gettext("Selected: ")+i.selection.label),i.options.onSelect(l,n))},this.element.keyup(function(e){var t=i.element.val().toLowerCase(),o=n.keys[t];return o?i.selection=i.cache.keys[t]:i.deselect(),e&&13===e.keyCode?(e.preventDefault(),e.stopPropagation(),void(o&&i.options.select.call(i,e,{item:i.selection}))):void(o&&(i.updateStyles(!0),i.options.onSelect(i.selection,!0)))}),i.options.requireValidOption&&i.element.val()&&i.search(i.element.val()),i.options._renderItem?i._renderItem=i.options._renderItem:i.options._renderItemAsLink&&(i._renderItem=function(t,i){return e("<li></li>").data("item.autocomplete",i).attr("title",i.url).append(e("<a></a>").text(i.label)).appendTo(t)})},reposition:function(){this.menu.element.position(e.extend({of:this.element},this.options.position))}}),e.fn.mozPlaceholder=function(){return this.each(function(){var t=e(this),i=t.attr("placeholder"),n=function(){var e=t[0];e.value===i&&(e.value="")};n(),t.bind({blur:n,focus:function(){""===t.val()&&t.val(i)}})})}}(jQuery);