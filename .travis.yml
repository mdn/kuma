cache:
    - apt
    - directories:
        - ~/.cache/pip
language: python
python:
    - "2.7"
services:
    - memcached
env:
    matrix:
        - TOXENV=py27
        - TOXENV=flake8
        - TOXENV=docs
    global:
        - PIP_WHEEL_DIR=$HOME/.cache/pip/wheels
        - PIP_FIND_LINKS=file://$HOME/.cache/pip/wheels
        - DJANGO_SETTINGS_MODULE=settings_travis
        - DEBIAN_FRONTEND=noninteractive
before_install: scripts/travis-install
install:
    - pip wheel -r requirements/compiled.txt coveralls
    - pip install -r requirements/compiled.txt coveralls tox==1.9.2
before_script:
#    - sudo ~/virtualenv/python2.7/bin/python scripts/travis-before-script.py
#    - sudo sed s/16M/128M/ /etc/mysql/my.cnf | sudo tee /etc/mysql/my.cnf
#    - sudo service mysql restart
    - mysql -e 'create database kuma;'
script: tox -v
after_success: coveralls
notifications:
    irc:
        channels:
            - "irc.mozilla.org#mdndev"
        on_success: always
        on_failure: always
        use_notice: true
